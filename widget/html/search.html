<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0" />
	<title>title</title>
	<link rel="stylesheet" type="text/css" href="../css/Hui.css" />
	<style>
		.bgg {
			background-image: url(../image/hd2.jpg);
			background-position: right bottom, left top;
		}

		;
		#main {
			height: 100%;
		}
	</style>
</head>

<body>
	<header class="H-header  bgg" id="header">
		<span tapmode="" onclick="H.closeWin();" class="H-icon H-position-relative H-display-block H-float-left H-vertical-middle H-theme-font-color-white H-padding-horizontal-both-10 H-z-index-1000"><i class="H-iconfont H-icon-arrow-left  H-font-size-18 H-vertical-middle"></i></span>
		<div class="H-header-title H-center-all H-font-size-18 H-text-show-row-1 H-theme-font-color-white H-position-absolute H-width-100-percent ">
			<div class="H-search H-flexbox-horizontal H-box-sizing-border-box  H-theme-background-color-transparent H-border-radius-3 H-overflow-hidden" style="width: 70%; height: 35px">
				<div name="keyword" id="search" placeholder="Search...." class="H-border-none H-theme-background-color-transparent H-flex-item H-font-size-16 H-padding-horizontal-both-10 H-padding-vertical-both-2 H-vertical-align-middle H-theme-border-color-ccc H-theme-font-color-white"
								style="border-width: 0 0 1px  0; "></div>
			</div>
		</div>
		<span tapmode onclick="cleanText()" class="H-z-index-100 H-icon H-position-absolute  H-display-block H-padding-horizontal-both-10 H-vertical-middle" style="right: 10px;"><i class="H-iconfont  H-icon-close H-font-size-18 H-theme-font-color-white"></i></span>
	</header>
</body>
<script type="text/javascript" src="../script/api.js"></script>
<script type="text/javascript" src="../script/H.js"></script>
<script type="text/javascript">
	var listdata = []
	var header, headerPos

	function closeWin() {
		api.closeWin();
		$api.rmStorage('h_list');
		var audioCover = api.require('audioCover');
		audioCover.cancel(function(ret, err) {});
	}

	function cleanText() {
		var UIInput = api.require('UIInput');
		UIInput.value({
			msg: ''
		});
	}

	apiready = function() {
		//		  $api.rmStorage('h_list');
		api.parseTapmode();
		searchbar()
		header = $api.byId('header');
		$api.fixStatusBar(header);
		headerPos = $api.offset(header);
		var body_h = $api.offset($api.dom('body')).h;
		open_frameGroup()

		// api.openFrame({
		// 	name: 'my_frm',
		// 	url: 'search_body.html',
		// 	bounces: false,
		// 	rect: {
		// 		x: 0,
		// 		y: headerPos.h,
		// 		w: headerPos.w,
		// 		h: 'auto'
		// 	}
		//
		// });
	};

	function searchbar() {
		var UIInput = api.require('UIInput');
		var searcht = $api.offset($api.byId('search')).t
		UIInput.open({
			rect: {
				x: (api.winWidth - (api.winWidth - 100)) / 2,
				y: searcht + 30,
				w: api.winWidth - 100,
				h: 30
			},
			styles: {
				bgColor: 'rgba(255,255,255,.15)',
				size: 14,
				color: '#fff',
				placeholder: {
					color: '#fff'
				}
			},
			autoFocus: true,
			maxRows: 1,
			placeholder: 'Search...',
			keyboardType: 'search',
			fixedOn: api.frameName
		}, function(ret, err) {
			if (ret.eventType == 'search') {
				UIInput.value(function(ret, err) {
					if (ret.msg != '') {
						if ($api.getStorage('h_list') !== [] && $api.getStorage('h_list')) {
							var listdata = $api.getStorage('h_list')
							listdata.push(ret.msg)
							$api.setStorage('h_list', listdata);
						} else {
							var listdata = []
							listdata.push(ret.msg)
							$api.setStorage('h_list', listdata);
						}
						api.sendEvent({
							name: 'smsg',
							extra: {
								msg: ret.msg
							}
						});
					} else {
						api.toast({
							msg: '输入不能为空'
						});
					}
				});
			} else {
				//					alert(JSON.stringify(err));
			}
		});
	}

	function open_frameGroup() {
		NVNavigationBar()
		api.openFrameGroup({
			name: 'searchGroup',
			background: '#fff',
			scrollEnabled: true,
			preload:5,
			rect: {
				x: 0,
				y: headerPos.h + 42,
				w: 'auto',
				h: 'auto'
			},
			index: 0,
			frames: [{
				name: 'netease',
				url: 'search_body.html',
				bgColor: '#fff',

			}, {
				name: 'tencent',
				url: 'search_body.html',
				bgColor: '#fff'
			}, {
				name: 'xiami',
				url: 'search_body.html',
				bgColor: '#fff'
			}, {
				name: 'kugou',
			url: 'search_body.html',
				bgColor: '#fff'
			}, {
				name: 'baidu',
		url: 'search_body.html',
				bgColor: '#fff'
			}]
		}, function(ret, err) {
			if (ret) {
				var index = ret.index
				setSelected(index)
			} else {
				// alert(JSON.stringify(err));
			}
		});

	}

	function NVNavigationBar() {
		var NVNavigationBar = api.require('NVNavigationBar');
		NVNavigationBar.open({
			rect: {
				x: 0,
				y: headerPos.h,
				w: api.frameWidth,
				h: 42
			},
			styles: {
				orientation: 'horizontal',
				bg: '#6b6b6b',
				bgAlpha: 1,
				font: {
					size: 14,
					sizeSelected: 18,
					color: '#FFFFFF',
					colorSelected: '#ff0000',
					alpha: 1
				},
				itemSize: {
					w: 90,
					h: 44
				}
			},
			items: [{
				title: '网易云',
				bg: 'red',
				bgSelected: '#FFA500'
			}, {
				title: 'QQ音乐',
				bg: 'red',
				bgSelected: '#FFA500'
			}, {
				title: '虾米',
				bg: 'red',
				bgSelected: '#FFA500'
			}, {
				title: '酷狗',
				bg: 'red',
				bgSelected: '#FFA500'
			}, {
				title: '百度',
				bg: 'red',
				bgSelected: '#FFA500'
			}],
			selectedIndex: 0,
			fixedOn: api.frameName,
			id: 'first'
		}, function(ret, err) {
      var index=ret.index
			api.setFrameGroupIndex({
				name: 'searchGroup',
				index: index
			});
		});
	}

	function setSelected(index) {
		var NVNavigationBar = api.require('NVNavigationBar');
		NVNavigationBar.setSelected({
			id: 'first',
			index: index,
			selected: true
		}, function(ret) {
			// alert(JSON.stringify(ret));
		});
	}
</script>

</html>
