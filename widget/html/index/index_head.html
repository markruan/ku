<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0" />
    <meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
    <title></title>
    <link rel="stylesheet" type="text/css" href="../../css/Hui.css" />
    <link rel="stylesheet" type="text/css" href="http://at.alicdn.com/t/font_1466120150_564351.css">
    <style type="text/css">
        .bgg {
            background-image: url(../../image/hd2.jpg);
            background-position: right bottom, left top;
        }

        #footer {
            position: fixed;
            bottom: 0px;
        }
    </style>
</head>

<body class="">
    <header class="H-header  bgg H-border-vertical-bottom-after" id="header">
        <span tapmode="" onclick="H.openSlidPane();" class="H-icon H-position-relative H-display-block H-float-left H-vertical-middle H-theme-font-color-white H-padding-horizontal-both-10 H-z-index-1000"><i class="H-iconfont H-icon-more-menu H-font-size-18 H-vertical-middle"></i></span>
        <div class="H-header-title H-center-all H-font-size-18 H-text-show-row-1 H-theme-font-color-white H-position-absolute H-width-100-percent ">
            <div class="H-search H-flexbox-horizontal H-box-sizing-border-box  H-theme-background-color-transparent H-border-radius-3 H-overflow-hidden" style="width: 70%; height: 35px">
                <input tapmode onclick="openS() " name="keyword" id="search" placeholder="Search...." class="H-border-none H-theme-background-color-transparent H-flex-item H-font-size-16 H-padding-horizontal-both-10 H-padding-vertical-both-2 H-vertical-align-middle H-theme-border-color-ccc H-theme-font-color-white"
                    style="border-width: 0 0 1px  0; ">
            </div>
        </div>
        <span class="H-icon H-position-relative H-display-block H-float-right H-vertical-middle H-theme-font-color-white H-padding-horizontal-both-5 H-z-index-1000" tapmode onclick="openkong()"><i  class="H-iconfont H-icon-add H-font-size-18 H-vertical-middle H-margin-horizontal-right-5"></i></span>
        <div class="H-flexbox-horizontal H-theme-background-color-white" id="tag">
            <div tapmode="" onclick="setPage(0, '../../html/page/page_frm.html');" class="H-flex-item H-center-all H-theme-font-color-red H-padding-vertical-both-10 H-theme-border-color-white  H-font-size-16 H-theme-border-color-52ace5 H-theme-font-color-52ace5 H-theme-border-color-red H-theme-font-color-red"
                style="border-width: 0 0 1px  0">
                精选
            </div>
            <div tapmode="" onclick="setPage(1, '../../html/quan/index.html');" class="H-flex-item H-center-all H-theme-font-color-666 H-padding-vertical-both-10 H-theme-border-color-white  H-font-size-16" style="border-width: 0 0 1px  0">
                圈子
            </div>
        </div>
    </header>
    <div class="H-main H-flex-item"></div>
    <footer class="H-footer H-flexbox-horizontal bgg H-border-vertical-top-after" id="footer">
        <div id="miniplayer">
            <span class="menu" tapmode="active" onclick="getMlistDB()"> </span>
            <div id="str6" class="radio" tapmode="active">
                <!--onclick="openRadioDetail()"openPlayer()-->
                <div tapmode onclick=" openPlayer()" class="inner" id="title" style="overflow-x:hidden;white-space:nowrap;width: 200px;">
                    新感官音乐
                </div>
            </div>
            <span id="pp" class="play" tapmode="focus" data-click="0" onclick="switchmusic(this)" data-mp3=""></span>
            <span class="next" tapmode="active" onclick="next()"></span>
        </div>
    </footer>
    <script type="text/javascript" src="../../script/H.js"></script>
    <script type="text/javascript" src="../../script/api.js"></script>
    <script type="text/javascript" src="../../script/touchpoint.js"></script>
    <script type="text/javascript">
        // 点击效果初始化
        // TouchPoint.color = 'white';
        // TouchPoint.size = 10;
        // TouchPoint.init();
        var playid = $api.byId('pp')

        // 底部打开播放页面
        function openPlayer() {
            $api.setStorage('listopen', false);
            if ($api.getStorage('isopen')) {
                api.openWin({
                    name: 'nww',
                    slidBackEnabled: false,
                    animation: {
                        type: "movein", //动画类型（详见动画类型常量）
                        subType: "from_bottom", //动画子类型（详见动画子类型常量）
                        duration: 500 //动画过渡时间，默认300毫秒
                    },
                });
            }
        }
        // 打开搜索页面
        function openS() {
            api.openWin({
                name: 'searsh',
                url: '../../html/search.html',
                animation: {
                    type: "fade", //动画类型（详见动画类型常量）
                    subType: "from_right", //动画子类型（详见动画子类型常量）
                    duration: 600 //动画过渡时间，默认300毫秒
                }
            });
        }
        // 打开添加内容页面
        function openkong() {
            api.openFrame({
                name: 'kong',
                url: "../../html/kong/index.html",

                bgColor: 'rgba(21, 20, 20, 0.37)',
                rect: {
                    x: 0,
                    y: 64,
                    w: 'auto',
                    h: 'auto',
                },
                // animation: {
                //     type: "cube", //动画类型（详见动画类型常量）
                //     subType: "from_bottom", //动画子类型（详见动画子类型常量）
                //     duration: 300
                // }
            });
        }


        // 底部控件-下一曲
        function next() {
            api.sendEvent({
                name: 'playNext'
            });
        }
        // 底部控件——播放
        function switchmusic(button) {
            var click = button.getAttribute("data-click");
            if (click == 0) {
                // 点开
                $api.attr(playid, 'class', 'play');
                button.setAttribute("data-click", 1);
                api.sendEvent({
                    name: 'pause'
                });

            } else {
                button.setAttribute("data-click", 0);
                api.sendEvent({
                    name: 'replaying'
                });
                $api.attr(playid, 'class', 'pause');
                //				}
            }
        }
        // 设置切换TAB 样式效果
        function setStyle(index) {
            var that = H.D("#tag div:nth-child(" + (index + 1) + ")");
            H.addClass(that, "H-theme-border-color-red H-theme-font-color-red");
            H.removeClass(H.siblings(that), "H-theme-border-color-red H-theme-font-color-red");
        }
        //设置首页显示页面
        function setPage(index, url) {
            setStyle(index);
            if (H.isAPICloud()) {
                H.setFrameGroupIndex("groups", index, true);
            } else {
                H.D("#H-frame").setAttribute("src", url);
            }
        }

        H.ready(function() {
            H.dblclickToCloseApp();
            var fs = api.require('fs');
            fs.createDir({
                path: 'fs://cache'
            }, function(ret, err) {
                if (ret.status) {
                    // alert(JSON.stringify(ret));
                } else {
                    // alert(JSON.stringify(err));
                }
            });

            // 监听耳机拔下事件
            var phoneListener = api.require('phoneListener');
            phoneListener.headphonePluggedListener({
                    enable: true
                },
                function(ret) {
                    if (!ret.state) {
                        api.sendEvent({
                            name: 'pause',
                        });
                    }

                });
            api.setWinAttr({
                bounces: false
            });
            api.addEventListener({
                name: 'playing'
            }, function(ret, err) {
                $api.attr(playid, 'class', 'pause');
                var txt = ret.value.songName + '-' + ret.value.artists
                $api.text($api.byId('title'), txt);
                $api.attr(playid, 'data-click', 0);
                stoploading();
            });
            api.addEventListener({
                name: 'replaying'
            }, function(ret, err) {
                $api.attr(playid, 'data-click', 0);
            });
            // api.addEventListener({
            //     name: 'resume'
            // }, function(ret, err) {
            //     $api.attr(playid, 'class', 'pause');
            // });
            api.addEventListener({
                name: 'pause'
            }, function(ret, err) {
                $api.attr($api.byId('pp'), 'class', 'play');
            });
            H.openFrameGroupNavOrFoot(function(ret, err) {
                setStyle(ret.index);
            }, "groups", [{
                url: '../../html/page/page_frm.html',
                name: 'kuxuan'
            }, {
                url: '../../html/quan/quan_index.html',
                name: 'quanzi'
            }], 0, "#header", "#footer");
        });


        //首页获取播放历史列表
        function getMlistDB() {
            api.openFrame({
                name: 'page2',
                url: 'history.html',
                rect: {
                    x: 0,
                    y: api.winHeight - 300,
                    w: api.winWidth,
                    h: 300
                },
                bounces: false,
                bgColor: 'rgba(0,0,0,0)',
                vScrollBarEnabled: true,
                hScrollBarEnabled: true
            });

        }

        // 登录测试获取cookie

    </script>
</body>

</html>
