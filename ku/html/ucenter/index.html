<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0" />
		<meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
		<title></title>
		<link rel="stylesheet" type="text/css" href="../../css/Hui.css" />
		<link rel="stylesheet" type="text/css" href="../../css/aui.css" />
		<style type="text/css">
			.H-margin-vertical-top-30 {
				margin-top: 185px;
			}
			.aui-waterfall li {
				width: 100%;
				position: relative;
				display: inline-block;
				margin-bottom: 1px;
				-webkit-column-break-inside: avoid;
			}
		</style>
	</head>
	<body class="H-flexbox-vertical">
		 <div class="  H-horizontal-center H-theme-background-color-transparent H-overflow-hidden H-position-fixed H-z-index-1000"   >
		<img   src="../../image/timg.jpg" / style="height: 221px;width: 100%; ">
		<div class="H-overflow-hidden H-max-width-100-percent H-padding-horizontal-both-10 H-box-sizing-border-box   "style="position: absolute;top:20px; margin-left: 33%; ">
		<div class="picture H-margin-vertical-top-1 H-position-relative  H-margin-horizontal-auto" style="width: 96px; height: 96px;">
		<span class="H-icon H-display-block H-position-absolute H-center-all H-border-radius-circle H-z-index-1000 H-line-height-0 H-theme-background-color9-active" style="height: 20px; width: 20px; bottom: 5px; right: 5px; "><i onclick="changePerson()" class="H-iconfont H-icon-camera H-theme-font-color-white H-font-size-12 H-vertical-align-middle"></i></span><img id="ico" src="../../image/qq.png" class="H-display-block H-border-radius-circle" alt="" title="" style="width: 90px; height: 90px; border:3px solid rgba(255,255,255,0.3);" />
		</div>
		<div id="name" class="H-display-block H-font-weight-normal H-font-weight-500 H-font-size-18 H-theme-font-color-white H-text-align-center H-margin-vertical-both-8 H-text-show-row-1">
		酷选
		</div>
		<div class="H-font-size-12 H-theme-font-color-white H-text-show-row-1">
		聆听音乐，感悟人生
		</div>
		</div>
		</div>
		 
		 </header> 
		<div class="H-padding-vertical-bottom-2" style="margin-top: 221px"></div>
		<div class="H-text-list H-flexbox-horizontal  H-theme-background-color-white H-border-vertical-bottom-margin-left-10-after H-vertical-middle H-touch-active">
			<span class="H-icon H-display-block H-margin-horizontal-left-10"><i class="H-iconfont H-icon-profile H-font-size-22 H-vertical-middle H-theme-font-color1"></i></span>
			<div class="H-flex-item H-padding-horizontal-both-10 H-font-size-16 H-padding-vertical-both-12">
				个人资料
			</div>
			<span class="H-icon H-padding-horizontal-right-5 H-display-block"><i class="H-iconfont H-icon-arrow-right H-theme-font-color-ccc H-font-size-14 H-vertical-middle"></i></span>
		</div>
		<div class="H-text-list H-flexbox-horizontal  H-theme-background-color-white H-border-vertical-bottom-margin-left-10-after H-vertical-middle H-touch-active">
			<span class="H-icon H-display-block H-margin-horizontal-left-10"><i class="H-iconfont H-icon-tip-msg H-font-size-22 H-vertical-middle H-theme-font-color2"></i></span>
			<div onclick="H.openWin('shoucang_head', 'shou_head.html');"  class="H-flex-item H-padding-horizontal-both-10 H-font-size-16 H-padding-vertical-both-12">
				收藏
			</div>
			<span class="H-badge H-display-block"><label class="H-display-inline-block H-vertical-middle H-theme-background-color4 H-theme-font-color-white H-font-size-12">99+</label></span>
			<span class="H-icon H-padding-horizontal-right-5 H-display-block"><i class="H-iconfont H-icon-arrow-right H-theme-font-color-ccc H-font-size-14 H-vertical-middle"></i></span>
		</div>
		<div class="H-text-list H-flexbox-horizontal  H-theme-background-color-white H-border-vertical-bottom-margin-left-10-after H-vertical-middle H-touch-active">
			<span class="H-icon H-display-block H-margin-horizontal-left-10"><i class="H-iconfont H-icon-weixin H-font-size-22 H-vertical-middle H-theme-font-color6"></i></span>
			<div class="H-flex-item H-padding-horizontal-both-10 H-font-size-16 H-padding-vertical-both-12">
				绑定微信
			</div>
			<span class="H-icon H-padding-horizontal-right-5 H-display-block"><i class="H-iconfont H-icon-arrow-right H-theme-font-color-ccc H-font-size-14 H-vertical-middle"></i></span>
		</div>
		<div class="H-text-list H-flexbox-horizontal  H-theme-background-color-white H-border-vertical-bottom-margin-left-10-after H-vertical-middle H-touch-active">
			<span class="H-icon H-display-block H-margin-horizontal-left-10"><i class="H-iconfont H-icon-friends H-font-size-22 H-vertical-middle H-theme-font-color7"></i></span>
			<div onclick="H.openWin('quan_head', 'quan_head.html')" class="H-flex-item H-padding-horizontal-both-10 H-font-size-16 H-padding-vertical-both-12">
				朋友圈
			</div>
			<span class="H-icon H-padding-horizontal-right-5 H-display-block"><i class="H-iconfont H-icon-arrow-right H-theme-font-color-ccc H-font-size-14 H-vertical-middle"></i></span>
		</div>
		<div class="H-text-list H-flexbox-horizontal  H-theme-background-color-white H-border-vertical-bottom-after H-vertical-middle H-touch-active">
			<span class="H-icon H-display-block H-margin-horizontal-left-10"><i class="H-iconfont H-icon-where H-font-size-22 H-vertical-middle H-theme-font-color5"></i></span>
			<div class="H-flex-item H-padding-horizontal-both-10 H-font-size-16 H-padding-vertical-both-12">
				附近的人
			</div>
			<span class="H-icon H-padding-horizontal-right-5 H-display-block"><i class="H-iconfont H-icon-arrow-right H-theme-font-color-ccc H-font-size-14 H-vertical-middle"></i></span>
		</div>
		<!--<div class="aui-content">
		<ul id="aui-waterfall"  class="  aui-waterfall"   ></ul>
		</div>-->
		<!--<div id="tppl"  class="result H-clear-both H-width-100-percent H-display-table H-box-sizing-border-box H-padding-horizontal-left-5"></div>-->
		<script type="text/javascript" src="../../script/H.js"></script>
		<script type="text/javascript" src="../../script/api.js"></script>
		<script type="text/javascript" src="../../script/echo.min.js"></script>
		<script type="text/javascript" src="../../script/aui-waterfall.js"></script>
		<script type="text/javascript">
			H.tppl_flag = ["<%", "%>"];
			function getIcon() {
				api.getPrefs({
					key : 'user'
				}, function(ret, err) {
					if (ret) {
						var name = ret.value
						api.ajax({
							url : hostUrl + '/userinfo.php',
							dataType : 'json',
							data : {
								values : {
									name : name
								}
							}
						}, function(ret, err) {
							if (ret) {
								var icon = ret[0].pic
						 	 $api.attr(person, 'src', icon);
							} else {
							}
						});
					} else {
						api.openFrame({
							name : 'ucenter',
							reload : 'true'
						});
					}
				});
			}

	 
			function setStyle(index) {
				var that = H.D("#tag div:nth-child(" + (index + 1) + ")");
				H.addClass(that, "H-theme-border-color9 H-theme-font-color9");
				H.removeClass(H.siblings(that), "H-theme-border-color9 H-theme-font-color9");
			}

			function setPage(index, url) {
				setStyle(index);
				if (H.isAPICloud()) {
					H.setFrameGroupIndex("groups", index, true);
				} else {
					H.D("#H-frame").setAttribute("src", url);
				}
			}


			H.ready(function() {
				init()
				//				getIcon()
				//				initPage()
				var personalCenter = api.require('personalCenter');
				api.addEventListener({
					name : 'reg_login_successEvent'
				}, function(ret, err) {
					 
					init()
					 
				});
				 api.addEventListener({
			name : 'iconupdata'
		}, function(ret, err) {
			var uid = $api.getStorage('userinfo').data_id
		
			api.ajax({
				timeout : 300,
				method : 'post',
				url : hostUrl + '/upload.php',
				data : {
					files : {
						upfile : ret.value.img_path
					},
				},
				dataType : 'text',
			}, function(ret, err) {
			 
				var img_path = hostUrl + '/' + trimStr(ret)
				api.ajax({
					url : hostUrl + '/updateicon.php',
					dataType : 'json',
					method : 'post',
					data : {
						values : {
							uid : uid,
							pic : img_path
						}
					}
				}, function(ret, err) {
					if (ret.status == 1) {
						api.toast({
							msg : ret.msg
						});
						personalCenter.updateValue({
							imgPath : img_path,
						});
						var userinfo= $api.getStorage('userinfo');
						userinfo.pic=img_path
						$api.setStorage('userinfo',userinfo);
					} else {
						api.toast({
							msg : ret.msg
						});
					}
				});
				 
			});
		});
				
				api.addEventListener({
					name : 'zhuxiao'
				}, function(ret, err) {
				 
					 init() 
				});
			});
			function initPage() {
				api.showProgress({
					title : ' 加载中...',
					text : '先喝杯茶...',
					modal : false
				})
				var html = ''
				api.getPrefs({
					key : 'user'
				}, function(ret, err) {
					if (ret.value) {
						api.ajax({
							url : hostUrl + '/quann.php',
							dataType : 'json',
							method : 'get',
							data : {
								values : {
									username : ret.value
								}
							}
						}, function(ret, err) {
							var data = {
								list : ret
							};
							for (var i = 0; i < ret.length; i++) {
								html += '	<li><div class="aui-waterfall-header"><img data-echo="' + ret[i].cover + '" src="../../image/default.jpg" />';
								html += '	</div>  </li>';
							}
							$api.html($api.byId('aui-waterfall'), html);
							$aui.waterfall($api.byId("aui-waterfall"), {
								col : 3, //列数
								padding : 1, //容器内边距
								space : 2//列间距
							});
							//							var render = H.tppl(H.D("#aui-waterfall").innerHTML);
							//							H.D(".aui-waterfall").innerHTML = render(data);
							//						懒加载
							echo.init({
								offset : 0,
								throttle : 350,
								unload : false,
								callback : function(element, op) {
								}
							});
						});
					} else {
						var html = '暂无信息'
						$api.html($api.byId("aui-waterfall"), html)
					}
				});
				api.hideProgress();
			}
			
			function init() {
				var userinfo = $api.getStorage('userinfo');
				if(!userinfo){
				
				var name = '未登录'
				var icon = 'widget://image/FM.jpg'
				}else{
				var name = userinfo.nickname
				var icon = userinfo.pic
				
				}
				
				var personalCenter = api.require('personalCenter');
				var btnArray = [{
					'bgImg' : 'widget://res/personalCenter/personal_btn_nor.png',
					'selectedImg' : 'widget://res/personalCenter/personal_btn_sele.png',
					'lightImg' : 'widget://res/personalCenter/personal_btn_light.png',
					'title' : '圈子',
					'count' : '5'
				}, {
					'bgImg' : 'widget://res/personalCenter/personal_btn_nor.png',
					'selectedImg' : 'widget://res/personalCenter/personal_btn_sele.png',
					'lightImg' : 'widget://res/personalCenter/personal_btn_light.png',
					'title' : '收藏',
					'count' : '240'
				},
 
				];
				var count = 382;
				var y = 0;
				personalCenter.open({
					'y' : y,
					'imgPath' : icon,
					'placeholderImg' : 'widget://image/timg.jpg',
					'userName' : name,
					'count' : count,
					'showRightBtn':false,
					'showLeftBtn':false,
					'subTitle':'聆听音乐 感悟人生',
					
					'modButton' : {
						'bgImg' : 'widget://image/xiang.png',
						'lightImg' : 'widget://image/slider/slider-btn.png'
					},
					fixedOn : api.frameName,
					fixed : false,
					'btnArray' : btnArray
				}, function(ret, err) {
					/* 头像修改按钮. */
					if (btnArray.length === ret.click) {
						api.confirm({
							title : '聊天盒子',
							msg : '您想要从哪里选取图片 ?',
							buttons : ['优雅自拍', '相册收藏', '取消']
						}, function(ret, err) {
							var sourceType = 'album';
							if (3 == ret.buttonIndex) {// 取消
								return;
							}
							if (1 == ret.buttonIndex) {// 打开相机
								sourceType = 'camera';
							}
							api.getPicture({
								sourceType : sourceType,
								encodingType : 'png',
								mediaValue : 'pic'
							}, function(ret, err) {
								if (ret) {
//									
									openImageClipFrame(ret.data)
									
									
								}
							});
						});
						return;
					}
					var msg;
					/* 修改按钮. */
					if (btnArray.length + 1 == ret.click) {
						msg = '您没有修改权限!';
					}
					if (btnArray.length + 2 == ret.click) {
						msg = '您没有设置权限!'
					}
					if (btnArray.length == ret.click) {
						btn = btnArray[ret.click];
						msg = btn.title + ' 数量为 ' + btn.count
						 
					}
					if(ret.click==0){
					
					   H.openWin('quan_head', 'quan_head.html')
					}else{
					   H.openWin('shoucang_head', 'shou_head.html')
					}
					
					 
 
				});
			}
		function openImageClipFrame(img_src) {
			api.openFrame({
				name : 'tu1',
				scrollToTop : true,
				allowEdit : true,
				url : 'tu.html',
				rect : {
					x : 0,
					y : 0,
					w : api.winWidth,
					h : api.winHeight,
				},
				animation : {
					type : "reveal", //动画类型（详见动画类型常量）
					subType : "from_right", //动画子类型（详见动画子类型常量）
					duration : 300
				},
				pageParam : {
					img_src : img_src
				},
				vScrollBarEnabled : false,
				hScrollBarEnabled : false,
				//页面是否弹动 为了下拉刷新使用
				bounces : false
			});
		}
	 	function trimStr(str) {
			return str.replace(/(^\s*)|(\s*$)/g, "");
		}
		</script>
	</body>
</html>